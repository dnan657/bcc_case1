# üöÄ –ü—Ä–æ–µ–∫—Ç "Benefit Engine" –¥–ª—è –•–∞–∫–∞—Ç–æ–Ω–∞

> _–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã–≥–æ–¥–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞. –ò–∑–º–µ—Ä–∏–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –±–∞–Ω–∫–∞._ üìà

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —Ö–∞–∫–∞—Ç–æ–Ω–∞ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é —Å–∏—Å—Ç–µ–º—ã –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—É—à-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π. –ú—ã –ø—Ä–æ—à–ª–∏ –ø—É—Ç—å –æ—Ç –ø—Ä–æ—Å—Ç–æ–π –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –¥–æ production-ready —Ä–µ—à–µ–Ω–∏—è, –∏ –∑–¥–µ—Å—å –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –∫–∞–∂–¥—ã–π —à–∞–≥.

## üéØ –ó–∞–¥–∞—á–∞ –•–∞–∫–∞—Ç–æ–Ω–∞

–ü–µ—Ä–µ—Å—Ç–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∫–ª–∏–µ–Ω—Ç–∞–º –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ, –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –ø—É—à-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è üö´.

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è:
*   ‚úÖ –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤—ã–º—ã—à–ª–µ–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ –¥–∞–Ω–Ω—ã–º –∑–∞ 3 –º–µ—Å—è—Ü–∞.
*   ‚úÖ –í—ã—á–∏—Å–ª—è–µ—Ç **–æ–∂–∏–¥–∞–µ–º—É—é –≤—ã–≥–æ–¥—É** –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ –∫–∞–∂–¥–æ–º—É –ø—Ä–æ–¥—É–∫—Ç—É.
*   ‚úÖ –í—ã–±–∏—Ä–∞–µ—Ç —Å–∞–º—ã–π –ø–æ–ª–µ–∑–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç.
*   ‚úÖ –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç **–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ –ø—É—à-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ** –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º Tone of Voice.

## üí° –ù–∞—à–µ –†–µ—à–µ–Ω–∏–µ: –î–≤–∏–∂–æ–∫ –ú–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏–∏ –í—ã–≥–æ–¥—ã

–ú—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–ª–∏ **"Benefit Engine"** ‚Äî —Å–∏—Å—Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ –∏–∑ –∏—Å–∫—É—Å—Å—Ç–≤–∞ –≤ —Ç–æ—á–Ω—É—é –Ω–∞—É–∫—É. –í–º–µ—Å—Ç–æ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã—Ö –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–π, –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –≤—ã–≥–æ–¥—ã.

1.  **üìä –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö:** –ú—ã –∞–≥—Ä–µ–≥–∏—Ä—É–µ–º —Å—ã—Ä—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ –ø–µ—Ä–µ–≤–æ–¥—ã –≤ –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏: —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç—Ä–∞—Ç, —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ—Ç–æ–∫–∏, –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–π –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ.

2.  **üî¢ –†–∞—Å—á–µ—Ç –≤—ã–≥–æ–¥—ã –≤ ‚Ç∏:** –î–ª—è **–∫–∞–∂–¥–æ–≥–æ** –±–∞–Ω–∫–æ–≤—Å–∫–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ (–æ—Ç –∫–∞—Ä—Ç –¥–æ –¥–µ–ø–æ–∑–∏—Ç–æ–≤) –º—ã —Å–æ–∑–¥–∞–ª–∏ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—É—é –º–µ—Å—è—á–Ω—É—é –≤—ã–≥–æ–¥—É –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ –≤ —Ç–µ–Ω–≥–µ. –ú–æ–¥–µ–ª–∏ —É—á–∏—Ç—ã–≤–∞—é—Ç –≤—Å—ë: –∫–µ—à–±—ç–∫, —ç–∫–æ–Ω–æ–º–∏—é –Ω–∞ –∫–æ–º–∏—Å—Å–∏—è—Ö, –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–π –¥–æ—Ö–æ–¥ –∏ —Ç.–¥.

3.  **‚úçÔ∏è –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—É—à–µ–π:** –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–æ—Ä–º—É–ª—É **"–ö–æ–Ω—Ç–µ–∫—Å—Ç + –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ + CTA"**. –ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å —Ñ–∞–∫—Ç–∞ –∏–∑ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –∂–∏–∑–Ω–∏ –∫–ª–∏–µ–Ω—Ç–∞, –¥–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—ã–≥–æ–¥—É –≤ —Ü–∏—Ñ—Ä–∞—Ö –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ.

## üå± –≠–≤–æ–ª—é—Ü–∏—è –†–µ—à–µ–Ω–∏—è: –û—Ç –ò–¥–µ–∏ –∫ –ü—Ä–æ–¥—É–∫—Ç—É

–í —ç—Ç–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –≤—ã –Ω–∞–π–¥–µ—Ç–µ 3 –∏—Ç–µ—Ä–∞—Ü–∏–∏ –Ω–∞—à–µ–≥–æ —Ä–µ—à–µ–Ω–∏—è. –ö–∞–∂–¥–∞—è ‚Äî —ç—Ç–æ —à–∞–≥ –≤–ø–µ—Ä–µ–¥ –≤ –ª–æ–≥–∏–∫–µ –∏ –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ–¥–∞.

### üë§ –í–µ—Ä—Å–∏—è 1: `main.py` (–ö–æ–Ω—Ü–µ–ø—Ü–∏—è "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –ê—Ä—Ö–µ—Ç–∏–ø")
*   **–ò–¥–µ—è:** –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏–π —Å—Ç–∏–ª—å –∂–∏–∑–Ω–∏ –∫–ª–∏–µ–Ω—Ç–∞ (–°–±–µ—Ä–µ–≥–∞—Ç–µ–ª—å, –ü—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫, –¢—Ä–∞—Ç—è—â–∏–π) –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –ª—É—á—à–∏–π –ø—Ä–æ–¥—É–∫—Ç –¥–ª—è —ç—Ç–æ–≥–æ –∞—Ä—Ö–µ—Ç–∏–ø–∞.
*   **–ü–ª—é—Å—ã:** –ü—Ä–æ—Å—Ç–æ—Ç–∞, –ª–æ–≥–∏—á–Ω–æ—Å—Ç—å, –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.
*   **–ú–∏–Ω—É—Å—ã:** –°–ª–∏—à–∫–æ–º —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥, –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –Ω—é–∞–Ω—Å—ã –∏ –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–æ—á–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å –ø—Ä–æ–¥—É–∫—Ç—ã –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π.

### üèóÔ∏è –í–µ—Ä—Å–∏—è 2: `main_v2.py` (–ü—Ä–æ—Ç–æ—Ç–∏–ø "Benefit Engine")
*   **–ò–¥–µ—è:** –ü–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –≤—ã–≥–æ–¥—É –æ—Ç –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ –≤ —Ç–µ–Ω–≥–µ. –í—Å–µ —Ä–∞—Å—á–µ—Ç—ã —Å–æ–±—Ä–∞–Ω—ã –≤ –æ–¥–Ω–æ–º –±–æ–ª—å—à–æ–º —Å–∫—Ä–∏–ø—Ç–µ.
*   **–ü–ª—é—Å—ã:** –õ–æ–≥–∏–∫–∞ —Å—Ç–∞–ª–∞ –≥–æ—Ä–∞–∑–¥–æ —É–º–Ω–µ–µ, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –∏–∑–º–µ—Ä–∏–º—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è—Ö.
*   **–ú–∏–Ω—É—Å—ã:** –ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —Å–ª–æ–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.

### üèÜ –í–µ—Ä—Å–∏—è 3 (–§–ò–ù–ê–õ): `main_v3.py` (Production-Ready "Benefit Engine")
*   **–ò–¥–µ—è:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏, –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏. **–≠—Ç–æ –Ω–∞—à–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∫ –∑–∞–ø—É—Å–∫—É —Ä–µ—à–µ–Ω–∏–µ.**
*   **–ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**
    *   **‚ö° –°–∫–æ—Ä–æ—Å—Ç—å:** –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `ThreadPoolExecutor`. –†–µ—à–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–º –Ω–∞–≥—Ä—É–∑–∫–∞–º.
    *   **üõ°Ô∏è –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞.
    *   **üéØ –¢–æ—á–Ω–æ—Å—Ç—å:** –£—Ç–æ—á–Ω–µ–Ω–Ω—ã–µ –∏ –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ —Ä–∞—Å—á–µ—Ç–∞ –≤—ã–≥–æ–¥—ã.
    *   **‚ú® –ß–∏—Å—Ç–æ—Ç–∞ –∫–æ–¥–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `dataclasses` –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, —á–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º Python.
    *   **üöÄ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é `pyarrow`.

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

*   **Python 3.10+** üêç
*   **Pandas** üêº ‚Äî –¥–ª—è –º–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö.
*   **NumPy** üî¢ ‚Äî –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö —á–∏—Å–ª–æ–≤—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.
*   **Tqdm** ‚è≥ ‚Äî –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.
*   **PyArrow** üèπ ‚Äî –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ CSV-—Ñ–∞–π–ª–æ–≤.

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è v3)

1.  **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
    ```bash
    git clone https://github.com/dnan657/bcc_case1
    cd bcc_case1
    ```

2.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
    ```bash
    pip install pandas numpy tqdm pyarrow
    ```

3.  **–ü–æ–ª–æ–∂–∏—Ç—å –¥–∞–Ω–Ω—ã–µ:**
    –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ CSV-—Ñ–∞–π–ª—ã –æ—Ç –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–æ–≤ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ `./data/`.

4.  **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç:**
    –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ. –ö–ª—é—á `--debug` —Å–æ–∑–¥–∞—Å—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π.
    ```bash
    python main_v3.py --debug
    ```

## üìÇ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–µ –ø–æ—è–≤—è—Ç—Å—è –¥–≤–∞ —Ñ–∞–π–ª–∞:

*   üìÑ `submissions_v3.csv` ‚Äî **–§–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è —Å–¥–∞—á–∏ –Ω–∞ —Ö–∞–∫–∞—Ç–æ–Ω.** –°–æ–¥–µ—Ä–∂–∏—Ç `client_code`, `product` –∏ `push_notification`.
*   üßê `submissions_v3_debug.csv` ‚Äî –ù–∞—à –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ñ–∞–π–ª –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –¢–û–ü-4 —Å–∞–º—ã—Ö –≤—ã–≥–æ–¥–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–∞ –∏ –∏—Ö –æ—Ü–µ–Ω–∫—É –≤ —Ç–µ–Ω–≥–µ.